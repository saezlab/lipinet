<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exploring SwissLipids from a network perspective &#8212; LipiNet 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Parsing SwissLipids into a network for LipiNet" href="parsing_swisslipids.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="exploring-swisslipids-from-a-network-perspective">
<h1>Exploring SwissLipids from a network perspective<a class="headerlink" href="#exploring-swisslipids-from-a-network-perspective" title="Link to this heading">¶</a></h1>
<section id="loading-dependencies-and-data">
<h2>Loading dependencies and data<a class="headerlink" href="#loading-dependencies-and-data" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lipinet.parse_swisslipids</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_swisslipids_data</span>

<span class="n">sl_results</span> <span class="o">=</span> <span class="n">parse_swisslipids_data</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_sl_nodes</span> <span class="o">=</span> <span class="n">sl_results</span><span class="p">[</span><span class="s1">&#39;df_nodes&#39;</span><span class="p">]</span>
<span class="n">df_sl_edges</span> <span class="o">=</span> <span class="n">sl_results</span><span class="p">[</span><span class="s1">&#39;df_edges&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">graph_tool.all</span><span class="w"> </span><span class="kn">import</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">GraphView</span><span class="p">,</span> <span class="n">graph_draw</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">graph_tool</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">onionnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">OnionNet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">onionnet.visualisation</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="building-the-network-with-onionnet">
<h2>Building the network with OnionNet<a class="headerlink" href="#building-the-network-with-onionnet" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onion</span> <span class="o">=</span> <span class="n">OnionNet</span><span class="p">()</span>

<span class="n">onion</span><span class="o">.</span><span class="n">grow_onion</span><span class="p">(</span><span class="n">df_nodes</span><span class="o">=</span><span class="n">df_sl_nodes</span><span class="p">,</span>
           <span class="n">df_edges</span><span class="o">=</span><span class="n">df_sl_edges</span><span class="p">,</span>
           <span class="n">node_prop_cols</span><span class="o">=</span><span class="n">df_sl_nodes</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
           <span class="n">edge_prop_cols</span><span class="o">=</span><span class="n">df_sl_edges</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
           <span class="n">drop_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">drop_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This has built the network, with about 2.7 million nodes and around 7 million edges - within 30 seconds on a decent laptop!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Graph object, directed, with 2783345 vertices and 6890979 edges, 34 internal vertex properties, 5 internal edge properties, at 0x3407e1af0&gt;
</pre></div>
</div>
</div>
</div>
<p>Hopefully it goes without saying that this is far too large to visualise for us at this stage. So instead we’ll begin by looking at the top of the network using the Lipid entry as the root node. We can see it in the table below, with the node_id <code class="docutils literal notranslate"><span class="pre">SLM:000389145</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sl_nodes</span><span class="p">[</span><span class="n">df_sl_nodes</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>layer</th>
      <th>node_id</th>
      <th>Lipid ID</th>
      <th>Level</th>
      <th>Name</th>
      <th>Abbreviation*</th>
      <th>Synonyms*</th>
      <th>Lipid class*</th>
      <th>Parent</th>
      <th>Components*</th>
      <th>...</th>
      <th>Exact m/z of [M+NH4]+</th>
      <th>Exact m/z of [M-H]-</th>
      <th>Exact m/z of [M+Cl]-</th>
      <th>Exact m/z of [M+OAc]-</th>
      <th>CHEBI</th>
      <th>LIPID MAPS</th>
      <th>HMDB</th>
      <th>MetaNetX</th>
      <th>PMID</th>
      <th>Components_parsed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6569869</th>
      <td>swisslipids</td>
      <td>SLM:000000525</td>
      <td>SLM:000000525</td>
      <td>Category</td>
      <td>Sphingolipids</td>
      <td>SL</td>
      <td>NaN</td>
      <td>SLM:000389145</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>26739</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNXM82564</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6622257</th>
      <td>swisslipids</td>
      <td>SLM:000001193</td>
      <td>SLM:000001193</td>
      <td>Category</td>
      <td>Glycerophospholipids</td>
      <td>GP</td>
      <td>NaN</td>
      <td>SLM:000389145</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37739</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNXM55319</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7681819</th>
      <td>swisslipids</td>
      <td>SLM:000117142</td>
      <td>SLM:000117142</td>
      <td>Category</td>
      <td>Glycerolipids</td>
      <td>GL</td>
      <td>NaN</td>
      <td>SLM:000389145</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35741</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNXM55310</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10570513</th>
      <td>swisslipids</td>
      <td>SLM:000389145</td>
      <td>SLM:000389145</td>
      <td>Category</td>
      <td>Lipid</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18059</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNXM12117</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10587719</th>
      <td>swisslipids</td>
      <td>SLM:000390054</td>
      <td>SLM:000390054</td>
      <td>Category</td>
      <td>Fatty acyls and derivatives</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SLM:000389145</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>61697</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNXM512004</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11503494</th>
      <td>swisslipids</td>
      <td>SLM:000500463</td>
      <td>SLM:000500463</td>
      <td>Category</td>
      <td>Steroids and derivatives</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SLM:000389145</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35341</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNXM682861</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11579041</th>
      <td>swisslipids</td>
      <td>SLM:000508860</td>
      <td>SLM:000508860</td>
      <td>Category</td>
      <td>Prenol Lipids</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SLM:000389145</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>26244</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>7 rows × 32 columns</p>
</div></div></div>
</div>
<p>We can get all these nodes on this level and visualise in a very simple plot</p>
<p>First, decode some of the graph properties to a more human readable format</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extra_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="s1">&#39;node_id&#39;</span><span class="p">]</span> <span class="c1">#, &#39;Lipid ID&#39;]</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">extra_vars</span><span class="p">:</span>
    <span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="n">var</span>
    <span class="p">)</span>
<span class="c1"># do the Lipid ID separately bc of the gaps</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;Lipid ID&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;lipidid_decoded&#39;</span>
    <span class="p">)</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;Lipid class*&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;lipidclass_decoded&#39;</span>
    <span class="p">)</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;name_decoded&#39;</span>
    <span class="p">)</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;Level&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;level_decoded&#39;</span>
    <span class="p">)</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;CHEBI&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;chebi_decoded&#39;</span>
    <span class="p">)</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;LIPID MAPS&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;lipidmaps_decoded&#39;</span>
    <span class="p">)</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;HMDB&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;hmdb_decoded&#39;</span>
    <span class="p">)</span>
<span class="n">onion</span><span class="o">.</span><span class="n">prop_manager</span><span class="o">.</span><span class="n">decode_property_labels</span><span class="p">(</span>
        <span class="n">encoded_prop_type</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> 
        <span class="n">encoded_prop_name</span><span class="o">=</span><span class="s1">&#39;interlayer&#39;</span><span class="p">,</span>
        <span class="n">new_prop_name</span><span class="o">=</span><span class="s1">&#39;interlayer_decoded&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;layer_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;node_id_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;lipidid_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;lipidclass_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;name_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;level_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;chebi_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;lipidmaps_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V property &#39;hmdb_decoded&#39; created successfully.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>E property &#39;interlayer_decoded&#39; created successfully.
</pre></div>
</div>
</div>
</div>
</section>
<section id="filtering-the-network">
<h2>Filtering the network<a class="headerlink" href="#filtering-the-network" title="Link to this heading">¶</a></h2>
<p>Now let’s use some filtering logic to only get those with the ‘Category’ level</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;level_decoded&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Category&#39;</span>
<span class="n">filtered_view</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">searcher</span><span class="o">.</span><span class="n">compose_filters</span><span class="p">(</span><span class="n">filter_funcs</span><span class="o">=</span><span class="p">[</span><span class="n">filter1</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;or&quot;</span><span class="p">)</span>
<span class="n">filtered_view</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GraphView object, directed, with 7 vertices and 6 edges, 43 internal vertex properties, 6 internal edge properties, edges filtered by &lt;EdgePropertyMap object with value type &#39;bool&#39;, for Graph 0x1058ca3c0, at 0x3407e3980&gt;, vertices filtered by &lt;VertexPropertyMap object with value type &#39;bool&#39;, for Graph 0x1058ca3c0, at 0x15b7db890&gt;, at 0x1058ca3c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_draw</span><span class="p">(</span>
    <span class="n">filtered_view</span><span class="p">,</span>
    <span class="n">vertex_text</span><span class="o">=</span><span class="n">filtered_view</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;name_decoded&#39;</span><span class="p">],</span> 
    <span class="n">vertex_text_position</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">vertex_size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">vertex_text_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/5e7e8e6cb469041a2778811d870a70b43fc3aa1b1cb35191fa94f83c77009c25.png"><img alt="../_images/5e7e8e6cb469041a2778811d870a70b43fc3aa1b1cb35191fa94f83c77009c25.png" src="../_images/5e7e8e6cb469041a2778811d870a70b43fc3aa1b1cb35191fa94f83c77009c25.png" style="width: 600px; height: 511px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x1058ca3c0, at 0x1058c9220&gt;
</pre></div>
</div>
</div>
</div>
<p>Now what if we want to get those of the Class too? Here we will combine these filters to do that. This time we will also avoid printing the node names since we have so many nodes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;level_decoded&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Category&#39;</span>
<span class="n">filter2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;level_decoded&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Class&#39;</span>
<span class="n">filtered_view</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">compose_filters</span><span class="p">([</span><span class="n">filter1</span><span class="p">,</span> <span class="n">filter2</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;or&quot;</span><span class="p">)</span>
<span class="n">filtered_view</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GraphView object, directed, with 813 vertices and 491 edges, 43 internal vertex properties, 6 internal edge properties, edges filtered by &lt;EdgePropertyMap object with value type &#39;bool&#39;, for Graph 0x487f238f0, at 0x17c652900&gt;, vertices filtered by &lt;VertexPropertyMap object with value type &#39;bool&#39;, for Graph 0x487f238f0, at 0x15b7db9b0&gt;, at 0x487f238f0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_draw</span><span class="p">(</span>
    <span class="n">filtered_view</span><span class="p">,</span>
    <span class="n">vertex_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">vertex_text_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/ff9f3a5f847b95056500b0cc1a8d43c131e6f3dab94cceb3b632da0765cd0f70.png"><img alt="../_images/ff9f3a5f847b95056500b0cc1a8d43c131e6f3dab94cceb3b632da0765cd0f70.png" src="../_images/ff9f3a5f847b95056500b0cc1a8d43c131e6f3dab94cceb3b632da0765cd0f70.png" style="width: 589px; height: 600px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x487f238f0, at 0x48b3f2a20&gt;
</pre></div>
</div>
</div>
</div>
<p>As we can see, this has resulted in many disjointed parts of the network. We may have to revisit our parsing process to double check this has worked correctly.</p>
<p>We can inspect the network on a more granular level too. First, we will find the index of the root node for lipids, then traverse the network.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lipids_root_node</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">get_vertex_by_name_tuple</span><span class="p">(</span><span class="n">layer_name</span><span class="o">=</span><span class="s1">&#39;swisslipids&#39;</span><span class="p">,</span> <span class="n">node_id_str</span><span class="o">=</span><span class="s1">&#39;SLM:000389145&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onion</span><span class="o">.</span><span class="n">searcher</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">start_node_idx</span><span class="o">=</span><span class="n">lipids_root_node</span><span class="p">,</span> 
                      <span class="n">max_dist</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                      <span class="n">node_text_prop</span><span class="o">=</span><span class="s1">&#39;node_id_decoded&#39;</span><span class="p">,</span>
                      <span class="n">vertex_text_position</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">vertex_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                      <span class="n">vertex_text_colour</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filtered graph contains 95 vertices and 94 edges.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/anaconda3/envs/onionnet_docs_env/lib/python3.12/site-packages/graph_tool/draw/cairo_draw.py:545: UserWarning: Unknown edge attribute: text_colour
  warnings.warn(f&quot;Unknown {kind} attribute: &quot; + str(k), UserWarning)
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/85abbb3e18b1a8b679d7a2c3fb5295fe8acbf6cec999603f028d970715e23bdb.png"><img alt="../_images/85abbb3e18b1a8b679d7a2c3fb5295fe8acbf6cec999603f028d970715e23bdb.png" src="../_images/85abbb3e18b1a8b679d7a2c3fb5295fe8acbf6cec999603f028d970715e23bdb.png" style="width: 600px; height: 591px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GraphView object, directed, with 95 vertices and 94 edges, 43 internal vertex properties, 6 internal edge properties, edges filtered by &lt;EdgePropertyMap object with value type &#39;bool&#39;, for Graph 0x1058ca2d0, at 0x48b3f2f30&gt;, vertices filtered by &lt;VertexPropertyMap object with value type &#39;bool&#39;, for Graph 0x1058ca2d0, at 0x48b3f2e70&gt;, at 0x1058ca2d0&gt;
</pre></div>
</div>
</div>
</div>
<p>We could also improve the visualisation of this network to show the different types of nodes</p>
<p>Also, because the swisslipid levels follow a hierarchy (https://www.swisslipids.org/#/about/lipid_hierarchy), we will specify this here directly and assign colors in a standardised manner.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cm</span>

<span class="n">sl_levels_custom_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">,</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span><span class="s1">&#39;Molecular subspecies&#39;</span><span class="p">,</span><span class="s1">&#39;Structural subspecies&#39;</span><span class="p">,</span><span class="s1">&#39;Isomeric subspecies&#39;</span><span class="p">,</span><span class="s1">&#39;nan&#39;</span><span class="p">]</span>
<span class="c1"># To use tab10</span>
<span class="c1"># sl_levels_custom_colordict = {cat: cm.tab10(i % len(sl_levels_custom_order)) for i, cat in enumerate(sl_levels_custom_order)}</span>
<span class="c1"># To use paired colormap, but swap around the order so it looks a little better</span>
<span class="c1"># sl_levels_custom_colordict = {</span>
<span class="c1">#     cat: cm.Paired((i ^ 1) % len(sl_levels_custom_order))</span>
<span class="c1">#     for i, cat in enumerate(sl_levels_custom_order)</span>
<span class="c1"># }</span>
<span class="c1"># To use normal paired colormap but swapping class and category cols</span>
<span class="n">sl_levels_custom_colordict</span> <span class="o">=</span> <span class="p">{</span><span class="n">cat</span><span class="p">:</span> <span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sl_levels_custom_order</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sl_levels_custom_order</span><span class="p">)}</span>
<span class="n">sl_levels_custom_colordict</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">sl_levels_custom_colordict</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="n">sl_levels_custom_colordict</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">],</span> <span class="s1">&#39;Class&#39;</span><span class="p">:</span> <span class="n">sl_levels_custom_colordict</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]}</span>
<span class="n">sl_levels_custom_colordict</span><span class="p">[</span><span class="s1">&#39;nan&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nodes</span>
<span class="n">color_result</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">color_nodes</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;level_decoded&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;categorical&quot;</span><span class="p">,</span> <span class="n">generate_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">custom_color_dict</span><span class="o">=</span><span class="n">sl_levels_custom_colordict</span><span class="p">)</span>
<span class="n">shape_result</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">shape_nodes</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s2">&quot;layer_decoded&quot;</span><span class="p">,</span> <span class="n">shape_method</span><span class="o">=</span><span class="s2">&quot;categorical&quot;</span><span class="p">,</span> <span class="n">generate_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">halo_result</span>  <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">add_halo_to_node</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">lipids_root_node</span><span class="p">)</span>

<span class="c1"># Edges</span>
<span class="n">edges_interlayer_col</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">color_edges</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">prop_name</span><span class="o">=</span><span class="s1">&#39;interlayer&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;boolean&#39;</span><span class="p">)</span>

<span class="c1"># Create summary dict for convenience</span>
<span class="n">graphic_styles</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">color_result</span><span class="p">,</span> <span class="o">**</span><span class="n">shape_result</span><span class="p">,</span> <span class="o">**</span><span class="n">halo_result</span><span class="p">,</span> <span class="o">**</span><span class="n">edges_interlayer_col</span><span class="p">}</span>
<span class="n">graphic_styles</span>

<span class="c1"># Assign some of the properties that we will likely be using often back to the graph</span>
<span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphic_styles</span><span class="p">[</span><span class="s1">&#39;v_color&#39;</span><span class="p">]</span>
<span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_shape_layer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphic_styles</span><span class="p">[</span><span class="s1">&#39;v_shape&#39;</span><span class="p">]</span>
<span class="n">onion</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ep</span><span class="p">[</span><span class="s1">&#39;e_color_inter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphic_styles</span><span class="p">[</span><span class="s1">&#39;e_color&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_res</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">searcher</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">start_node_idx</span><span class="o">=</span><span class="n">lipids_root_node</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">graph_draw</span><span class="p">(</span><span class="n">search_res</span><span class="p">,</span>
           <span class="n">vertex_text</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;node_id_decoded&#39;</span><span class="p">],</span>
            <span class="n">vertex_text_position</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">vertex_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">vertex_text_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="c1"># here we add the graphics from above</span>
            <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span>
            <span class="n">vertex_shape</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_shape_layer&#39;</span><span class="p">],</span>
            <span class="n">edge_color</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">ep</span><span class="p">[</span><span class="s1">&#39;e_color_inter&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filtered graph contains 95 vertices and 94 edges.
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/6246cc5b5a0ccbaa346a49dd7e998ee1f121e3311c23650d1414db2f6055b30c.png"><img alt="../_images/6246cc5b5a0ccbaa346a49dd7e998ee1f121e3311c23650d1414db2f6055b30c.png" src="../_images/6246cc5b5a0ccbaa346a49dd7e998ee1f121e3311c23650d1414db2f6055b30c.png" style="width: 600px; height: 588px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x3507101d0, at 0x3406eb020&gt;
</pre></div>
</div>
</div>
</div>
<p>This hints towards a problem in the SL data. If we look closely we can see that the nodes are coloured by level in the case they are swisslipids. Already we can see that many of the SL lipids do not have an assigned ‘level’. This is most likely why when we used our ‘Level’ filter functionality earlier for the top two highest levels, these nodes were not included, and hence the resulting graph would have appeared far more disjointed than in actual fact it is.</p>
<p>Furthermore if we take an even closer look into some of these, we see that some of the lipids have SL identifiers and ChEBI identifiers, such as ‘SLM:000000436’ which is ‘phospholipid’. But this also does not have a Level assigned to it, has only a single child entry, and if we take a look at the SL data online, it is not included in any of the 7 official categories below Lipids. Instead, one of the other major categories is ‘Glycerophospholipids’, which is a subset of it. While perhaps this may seem trivial, it suggests these kind of problems could be widespread, and they could have ramifications on how we categorise the data or link it to other resources (such as ChEBI).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_res</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">searcher</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">start_node_idx</span><span class="o">=</span><span class="n">lipids_root_node</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">graph_draw</span><span class="p">(</span><span class="n">search_res</span><span class="p">,</span>
           <span class="n">vertex_text</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;node_id_decoded&#39;</span><span class="p">],</span>
            <span class="n">vertex_text_position</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">vertex_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">800</span><span class="p">),</span>
            <span class="c1">#output=&#39;testing_sl.svg&#39;,</span>
            <span class="n">vertex_text_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="c1"># here we add the graphics from above</span>
            <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span>
            <span class="n">vertex_shape</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_shape_layer&#39;</span><span class="p">],</span>
            <span class="n">edge_color</span><span class="o">=</span><span class="n">search_res</span><span class="o">.</span><span class="n">ep</span><span class="p">[</span><span class="s1">&#39;e_color_inter&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filtered graph contains 734 vertices and 749 edges.
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/141e2da065e95ab202c02e35bf262ea76662fa91583b674f619e80c53c43f403.png"><img alt="../_images/141e2da065e95ab202c02e35bf262ea76662fa91583b674f619e80c53c43f403.png" src="../_images/141e2da065e95ab202c02e35bf262ea76662fa91583b674f619e80c53c43f403.png" style="width: 663px; height: 800px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x487f23e00, at 0x4299375c0&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploring-bipartite-networks">
<h2>Exploring bipartite networks<a class="headerlink" href="#exploring-bipartite-networks" title="Link to this heading">¶</a></h2>
<section id="chebi">
<h3>ChEBI<a class="headerlink" href="#chebi" title="Link to this heading">¶</a></h3>
<p>Now what if we want to look at how ChEBI’s map to SwissLipids, and whether there are overlaps?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer_1</span> <span class="o">=</span> <span class="s1">&#39;swisslipids&#39;</span>
<span class="n">layer_2</span> <span class="o">=</span> <span class="s1">&#39;sl_chebi&#39;</span>
<span class="n">gv2</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">create_bipartite_gv</span><span class="p">(</span><span class="n">layer1</span><span class="o">=</span><span class="n">layer_1</span><span class="p">,</span> <span class="n">layer2</span><span class="o">=</span><span class="n">layer_2</span><span class="p">)</span>
<span class="n">gv2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GraphView object, directed, with 8555 vertices and 4279 edges, 45 internal vertex properties, 7 internal edge properties, edges filtered by &lt;EdgePropertyMap object with value type &#39;bool&#39;, for Graph 0x48b3f2ae0, at 0x429919430&gt;, vertices filtered by &lt;VertexPropertyMap object with value type &#39;bool&#39;, for Graph 0x48b3f2ae0, at 0x429919580&gt;, at 0x48b3f2ae0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_draw</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span> 
           <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">800</span><span class="p">),</span>
           <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
           <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span> <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/5e6b57ff5783c3978215f8541a35fefbb7cebc4bcea8e085ea7ed15a831e9a9a.png"><img alt="../_images/5e6b57ff5783c3978215f8541a35fefbb7cebc4bcea8e085ea7ed15a831e9a9a.png" src="../_images/5e6b57ff5783c3978215f8541a35fefbb7cebc4bcea8e085ea7ed15a831e9a9a.png" style="width: 800px; height: 799px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x48b3f2ae0, at 0x340785850&gt;
</pre></div>
</div>
</div>
</div>
<p>If we wanted to, we could also colour this plot by the SL level. But in this case it probably isn’t informative anway since they are so scattered.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#graph_draw(gv2, vertex_fill_color=search_res.vp[&#39;v_color_level&#39;])</span>
</pre></div>
</div>
</div>
</div>
<p>What we will do instead is plot the bipartite layout separated by each layer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example usage:</span>
<span class="c1"># Assume gv2 is your filtered GraphView and each vertex has a &#39;layer_decoded&#39; property.</span>
<span class="n">pos_by_layer</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">layout_by_layer</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span> <span class="n">layer_prop_name</span><span class="o">=</span><span class="s1">&#39;layer_decoded&#39;</span><span class="p">)</span>
<span class="n">graph_draw</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span>
              <span class="n">pos</span><span class="o">=</span><span class="n">pos_by_layer</span><span class="p">,</span>
              <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span>
              <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
              <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span>
              <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/16ee80270e1d1e527fb7ad62833387704d01333b95260b82c3a03f6a2caa1a15.png"><img alt="../_images/16ee80270e1d1e527fb7ad62833387704d01333b95260b82c3a03f6a2caa1a15.png" src="../_images/16ee80270e1d1e527fb7ad62833387704d01333b95260b82c3a03f6a2caa1a15.png" style="width: 800px; height: 800px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x48b3f2ae0, at 0x3405c4080&gt;
</pre></div>
</div>
</div>
</div>
<p>This plot wasn’t awfully informative in this case, because most of the connections between SL and ChEBI appear to have 1:1 relationships. But this in itself is still good to know, because prima facie it would appear there is little ambiguity in the mapping between these two type of formats.</p>
<p>Now let’s try another layer</p>
</section>
<section id="pmid">
<h3>PMID<a class="headerlink" href="#pmid" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer_1</span> <span class="o">=</span> <span class="s1">&#39;swisslipids&#39;</span>
<span class="n">layer_2</span> <span class="o">=</span> <span class="s1">&#39;sl_pmid&#39;</span>
<span class="n">gv2</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">create_bipartite_gv</span><span class="p">(</span><span class="n">layer1</span><span class="o">=</span><span class="n">layer_1</span><span class="p">,</span> <span class="n">layer2</span><span class="o">=</span><span class="n">layer_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos_sfdp_pmid_bipartite</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">load_or_compute_layout</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;.data/.explore_sl_pos_sfdp_pmid_bipartite.tsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loaded layout for 5770 vertices from .data/.explore_sl_pos_sfdp_pmid_bipartite.tsv
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_draw</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span> 
           <span class="n">vertex_size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
           <span class="n">vertex_pen_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
           <span class="n">pos</span><span class="o">=</span><span class="n">pos_sfdp_pmid_bipartite</span><span class="p">,</span>
           <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span>
           <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
           <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span> 
           <span class="n">vertex_shape</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_shape_layer&#39;</span><span class="p">],</span>
           <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">get_legend</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">graphic_styles</span><span class="p">[</span><span class="s1">&#39;legend_node_color&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Legend: SL Lipid Level&#39;</span><span class="p">,</span>
                                  <span class="n">ordered_cats</span><span class="o">=</span><span class="n">sl_levels_custom_order</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="s1">&#39;.data/explore_sl_pmid_to_sl_legend_cols&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/8f384e480726fb2b85b182722605ba97d24500b6d4fe9201dc6a391520353022.png"><img alt="../_images/8f384e480726fb2b85b182722605ba97d24500b6d4fe9201dc6a391520353022.png" src="../_images/8f384e480726fb2b85b182722605ba97d24500b6d4fe9201dc6a391520353022.png" style="width: 987px; height: 1000px;" />
</a>
<img alt="../_images/36153a61b471a29acaac227f084cba01653f4eb2aae41637d5213dead808bcd1.png" src="../_images/36153a61b471a29acaac227f084cba01653f4eb2aae41637d5213dead808bcd1.png" />
</div>
</div>
<p>Finally, an interesting finding visually from a network perspective, because we can see the relationships between the SL IDs and the PMIDs, being the published literature. This shows:</p>
<ul class="simple">
<li><p><strong>Some</strong> lipids have been <strong>widely studied</strong> across the literature</p></li>
<li><p>But <strong>many lipids</strong> may be <strong>understudied</strong> (plus those without PMID)</p></li>
<li><p>Studies tend to be associated with lipids of the <strong>same level</strong> (i.e. colour), probably due to shared experimental methods</p></li>
<li><p>Possible <strong>bias</strong> towards annotations at class, species or isomeric levels</p></li>
</ul>
<p>If we want to, we could also save a copy of this network to file as an SVG, with or without the text labels included too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># temp_nodesize = 4</span>
<span class="c1"># temp_outsize = (800,800)</span>
<span class="c1"># include_text = False</span>
<span class="c1"># if include_text:</span>
<span class="c1">#     graph_draw(gv2, </span>
<span class="c1">#             vertex_size=temp_nodesize,</span>
<span class="c1">#             output_size=temp_outsize,</span>
<span class="c1">#             vertex_pen_width=0,</span>
<span class="c1">#             pos=pos_sfdp_pmid_bipartite,</span>
<span class="c1">#             edge_pen_width=0.50,</span>
<span class="c1">#             vertex_fill_color=gv2.vp[&#39;v_color_level&#39;], </span>
<span class="c1">#             vertex_shape=gv2.vp[&#39;v_shape_layer&#39;],</span>
<span class="c1">#             nodesfirst=False,</span>
<span class="c1">#             vertex_text=gv2.vp[&#39;node_id_decoded&#39;],</span>
<span class="c1">#             vertex_text_position=-2,</span>
<span class="c1">#             vertex_text_color=&#39;black&#39;,</span>
<span class="c1">#             output=&#39;.data/explore_sl_network_pmid_to_sl_withtext.svg&#39;</span>
<span class="c1">#             )</span>
<span class="c1"># else:</span>
<span class="c1">#     graph_draw(gv2, </span>
<span class="c1">#             vertex_size=temp_nodesize,</span>
<span class="c1">#             output_size=temp_outsize,</span>
<span class="c1">#             vertex_pen_width=0,</span>
<span class="c1">#             pos=pos_sfdp_pmid_bipartite,</span>
<span class="c1">#             edge_pen_width=0.50,</span>
<span class="c1">#             vertex_fill_color=gv2.vp[&#39;v_color_level&#39;], </span>
<span class="c1">#             vertex_shape=gv2.vp[&#39;v_shape_layer&#39;],</span>
<span class="c1">#             nodesfirst=False,</span>
<span class="c1">#             output=&#39;.data/explore_sl_network_pmid_to_sl.svg&#39;</span>
<span class="c1">#             )</span>
</pre></div>
</div>
</div>
</div>
<p>Again we can create another bipartite network to inspect this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># gv2 is the filtered GraphView and each vertex has a &#39;layer_decoded&#39; property.</span>
<span class="n">pos_by_layer</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">layout_by_layer</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span> <span class="n">layer_prop_name</span><span class="o">=</span><span class="s1">&#39;layer_decoded&#39;</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">graph_draw</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span>
              <span class="n">pos</span><span class="o">=</span><span class="n">pos_by_layer</span><span class="p">,</span>
              <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span>
              <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
              <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span>
              <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/7677e96abea862101762d3691212b6a5881d97c6fb8963def8c9353fadc8a6d3.png"><img alt="../_images/7677e96abea862101762d3691212b6a5881d97c6fb8963def8c9353fadc8a6d3.png" src="../_images/7677e96abea862101762d3691212b6a5881d97c6fb8963def8c9353fadc8a6d3.png" style="width: 800px; height: 800px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x487f22570, at 0x340563aa0&gt;
</pre></div>
</div>
</div>
</div>
<p>This seems to show some lipid nodes with a very high number of connections to the publications, like we saw in the first network plot. But to get a better indication of this we will increase the node sizes, switch their location to the left-handside, and sort them into their classes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos_ord_bipartite</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">bipartite_ordered_layout</span><span class="p">(</span>
    <span class="n">gv2</span><span class="p">,</span>
    <span class="n">layer_prop</span><span class="o">=</span><span class="s1">&#39;layer_decoded&#39;</span><span class="p">,</span>
    <span class="n">left_val</span><span class="o">=</span><span class="n">layer_1</span><span class="p">,</span>
    <span class="n">right_val</span><span class="o">=</span><span class="n">layer_2</span><span class="p">,</span>
    <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> 
    <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">6000.0</span><span class="p">,</span>
    <span class="n">sort_left_by</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">graph_draw</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span>
              <span class="n">pos</span><span class="o">=</span><span class="n">pos_ord_bipartite</span><span class="p">,</span>
              <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span>
              <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
              <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span>
              <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">vertex_pen_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">vertex_size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">get_legend</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">graphic_styles</span><span class="p">[</span><span class="s1">&#39;legend_node_color&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Legend: SL Lipid Level&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/ee7c0dc59a1f04de32f8ef10a9d272c944d1c081b6485657ecb7f48accca78b7.png"><img alt="../_images/ee7c0dc59a1f04de32f8ef10a9d272c944d1c081b6485657ecb7f48accca78b7.png" src="../_images/ee7c0dc59a1f04de32f8ef10a9d272c944d1c081b6485657ecb7f48accca78b7.png" style="width: 783px; height: 800px;" />
</a>
<img alt="../_images/36153a61b471a29acaac227f084cba01653f4eb2aae41637d5213dead808bcd1.png" src="../_images/36153a61b471a29acaac227f084cba01653f4eb2aae41637d5213dead808bcd1.png" />
</div>
</div>
<p>From this we can now see that many of the nodes with the most connections to the literature are of the <code class="docutils literal notranslate"><span class="pre">Isomeric</span> <span class="pre">subspecies</span></code> level, and to a slightly lesser extent, in the <code class="docutils literal notranslate"><span class="pre">Class</span></code> level. So the most well studied lipids seem to be at these levels, at least qualitatively.</p>
<p>In contrast, we can see that many of the lipids in the <code class="docutils literal notranslate"><span class="pre">Species</span></code> class have come from a very small number of papers.</p>
</section>
<section id="hmdb">
<h3>HMDB<a class="headerlink" href="#hmdb" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer_1</span> <span class="o">=</span> <span class="s1">&#39;swisslipids&#39;</span>
<span class="n">layer_2</span> <span class="o">=</span> <span class="s1">&#39;sl_hmdb&#39;</span>
<span class="n">gv2</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">create_bipartite_gv</span><span class="p">(</span><span class="n">layer1</span><span class="o">=</span><span class="n">layer_1</span><span class="p">,</span> <span class="n">layer2</span><span class="o">=</span><span class="n">layer_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_draw</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span> 
           <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">800</span><span class="p">),</span>
           <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
           <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span> 
           <span class="n">vertex_shape</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_shape_layer&#39;</span><span class="p">],</span>
           <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/e610b23062d8f9397817a4a631ba51395042156312ba245661238de3c92590fb.png"><img alt="../_images/e610b23062d8f9397817a4a631ba51395042156312ba245661238de3c92590fb.png" src="../_images/e610b23062d8f9397817a4a631ba51395042156312ba245661238de3c92590fb.png" style="width: 800px; height: 797px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x17ba0bbc0, at 0x11af27980&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos_by_layer</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">layout_by_layer</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span> <span class="n">layer_prop_name</span><span class="o">=</span><span class="s1">&#39;layer_decoded&#39;</span><span class="p">)</span>
<span class="n">graph_draw</span><span class="p">(</span><span class="n">gv2</span><span class="p">,</span>
              <span class="n">pos</span><span class="o">=</span><span class="n">pos_by_layer</span><span class="p">,</span>
              <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span>
              <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
              <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv2</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span>
              <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/535feb039791734012dee89d1bec7d602c6cc3478cac9cf66e1bfc295225618b.png"><img alt="../_images/535feb039791734012dee89d1bec7d602c6cc3478cac9cf66e1bfc295225618b.png" src="../_images/535feb039791734012dee89d1bec7d602c6cc3478cac9cf66e1bfc295225618b.png" style="width: 800px; height: 800px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x17ba0bbc0, at 0x11b4e54f0&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="lipidmaps">
<h3>LipidMaps<a class="headerlink" href="#lipidmaps" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer_1</span> <span class="o">=</span> <span class="s1">&#39;swisslipids&#39;</span>
<span class="n">layer_2</span> <span class="o">=</span> <span class="s1">&#39;sl_lipidmaps&#39;</span>
<span class="n">gv</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">create_bipartite_gv</span><span class="p">(</span><span class="n">layer1</span><span class="o">=</span><span class="n">layer_1</span><span class="p">,</span> <span class="n">layer2</span><span class="o">=</span><span class="n">layer_2</span><span class="p">)</span>
<span class="n">gv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GraphView object, directed, with 24229 vertices and 12117 edges, 45 internal vertex properties, 7 internal edge properties, edges filtered by &lt;EdgePropertyMap object with value type &#39;bool&#39;, for Graph 0x1058ca5d0, at 0x429934ec0&gt;, vertices filtered by &lt;VertexPropertyMap object with value type &#39;bool&#39;, for Graph 0x1058ca5d0, at 0x429937ad0&gt;, at 0x1058ca5d0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_draw</span><span class="p">(</span><span class="n">gv</span><span class="p">,</span> 
           <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">800</span><span class="p">),</span>
           <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
           <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span> 
           <span class="n">vertex_shape</span><span class="o">=</span><span class="n">gv</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_shape_layer&#39;</span><span class="p">],</span>
           <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/c8a08f97dac5068ef0e7e440285b8b78df61d8b969c915e810bb7421a670295f.png"><img alt="../_images/c8a08f97dac5068ef0e7e440285b8b78df61d8b969c915e810bb7421a670295f.png" src="../_images/c8a08f97dac5068ef0e7e440285b8b78df61d8b969c915e810bb7421a670295f.png" style="width: 800px; height: 800px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x1058ca5d0, at 0x37fcc8500&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos_by_layer</span> <span class="o">=</span> <span class="n">onionnet</span><span class="o">.</span><span class="n">visualisation</span><span class="o">.</span><span class="n">layout_by_layer</span><span class="p">(</span><span class="n">gv</span><span class="p">,</span> <span class="n">layer_prop_name</span><span class="o">=</span><span class="s1">&#39;layer_decoded&#39;</span><span class="p">)</span>
<span class="n">graph_draw</span><span class="p">(</span><span class="n">gv</span><span class="p">,</span>
              <span class="n">pos</span><span class="o">=</span><span class="n">pos_by_layer</span><span class="p">,</span>
              <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span>
              <span class="n">edge_pen_width</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
              <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">gv</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;v_color_level&#39;</span><span class="p">],</span>
              <span class="n">nodesfirst</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/017a9647394bd559656e53787468286e0b42a8024da88208a485c079836a6103.png"><img alt="../_images/017a9647394bd559656e53787468286e0b42a8024da88208a485c079836a6103.png" src="../_images/017a9647394bd559656e53787468286e0b42a8024da88208a485c079836a6103.png" style="width: 800px; height: 800px;" />
</a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;VertexPropertyMap object with value type &#39;vector&lt;double&gt;&#39;, for Graph 0x1058ca5d0, at 0x48b3f3a10&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="sl-components-parsed">
<h3>SL Components (parsed)<a class="headerlink" href="#sl-components-parsed" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer_1</span> <span class="o">=</span> <span class="s1">&#39;swisslipids&#39;</span>
<span class="n">layer_2</span> <span class="o">=</span> <span class="s1">&#39;sl_components_parsed&#39;</span>
<span class="n">gv</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">create_bipartite_gv</span><span class="p">(</span><span class="n">layer1</span><span class="o">=</span><span class="n">layer_1</span><span class="p">,</span> <span class="n">layer2</span><span class="o">=</span><span class="n">layer_2</span><span class="p">)</span>
<span class="n">gv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GraphView object, directed, with 767000 vertices and 1852844 edges, 45 internal vertex properties, 7 internal edge properties, edges filtered by &lt;EdgePropertyMap object with value type &#39;bool&#39;, for Graph 0x487f223c0, at 0x37fc4e510&gt;, vertices filtered by &lt;VertexPropertyMap object with value type &#39;bool&#39;, for Graph 0x487f223c0, at 0x37fc4c4a0&gt;, at 0x487f223c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">degree_property_map</span><span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        765323
1           623
4            74
474          69
30           67
2            64
70           64
12           63
6            55
21           51
7            51
20           45
11           37
29           33
9            30
39           29
7263         29
15439        29
5617         28
2350         25
10           25
42           18
6114         17
3473         16
17           16
486          13
31456        12
19           12
410          12
13           10
32            9
16            9
7311          8
45            8
31492         8
14            4
5629          4
36            1
6531          1
6113          1
473           1
15475         1
469           1
5             1
475           1
15438         1
3383          1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We won’t visualise this, because it would be far too large.</p>
</section>
<section id="sl-synonyms">
<h3>SL Synonyms<a class="headerlink" href="#sl-synonyms" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layer_1</span> <span class="o">=</span> <span class="s1">&#39;swisslipids&#39;</span>
<span class="n">layer_2</span> <span class="o">=</span> <span class="s1">&#39;sl_synonyms&#39;</span>
<span class="n">gv</span> <span class="o">=</span> <span class="n">onion</span><span class="o">.</span><span class="n">create_bipartite_gv</span><span class="p">(</span><span class="n">layer1</span><span class="o">=</span><span class="n">layer_1</span><span class="p">,</span> <span class="n">layer2</span><span class="o">=</span><span class="n">layer_2</span><span class="p">)</span>
<span class="n">gv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GraphView object, directed, with 1083210 vertices and 568258 edges, 45 internal vertex properties, 7 internal edge properties, edges filtered by &lt;EdgePropertyMap object with value type &#39;bool&#39;, for Graph 0x487f22210, at 0x37fc4e810&gt;, vertices filtered by &lt;VertexPropertyMap object with value type &#39;bool&#39;, for Graph 0x487f22210, at 0x37fc4d9a0&gt;, at 0x487f22210&gt;
</pre></div>
</div>
</div>
</div>
<p>We won’t visualise this, because it would be far too large.</p>
<p>But we can inspect the in- and out-degree of the nodes to identify what the most commonly shared synonyms are for the lipids and their identifiers, thereby identifying which have ambiguities.</p>
<p>First we will consider the ‘in’ degree of the nodes. Since the SL IDs point towards the synonyms, this will indicate the distribution of synonyms that are shared with others.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute in-degree centrality</span>
<span class="n">deg</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">degree_property_map</span><span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    548163
1    504991
2     28517
4      1467
3        38
8        27
5         7
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can now get all synonyms that, for instance, are mapped to 5 or more SL IDs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">gv</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;node_id_decoded&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">gv</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span> <span class="k">if</span> <span class="n">gv</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;layer_decoded&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sl_synonyms&#39;</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Diacylglycerol (O-)&#39;,
 &#39;Lysophosphatidate&#39;,
 &#39;Lysophosphatidylcholine&#39;,
 &#39;Lysophosphatidylethanolamine&#39;,
 &#39;Lysophosphatidylglycerol&#39;,
 &#39;Lysophosphatidylinositol&#39;,
 &#39;Lysophosphatidylserine&#39;,
 &#39;Triacylglycerol (13:0/13:0/13:0)&#39;,
 &#39;Triacylglycerol (13:0/13:0/15:0)&#39;,
 &#39;Triacylglycerol (13:0/13:0/17:0)&#39;,
 &#39;Triacylglycerol (13:0/15:0/13:0)&#39;,
 &#39;Triacylglycerol (13:0/15:0/15:0)&#39;,
 &#39;Triacylglycerol (13:0/15:0/17:0)&#39;,
 &#39;Triacylglycerol (13:0/17:0/13:0)&#39;,
 &#39;Triacylglycerol (13:0/17:0/15:0)&#39;,
 &#39;Triacylglycerol (13:0/17:0/17:0)&#39;,
 &#39;Triacylglycerol (15:0/13:0/13:0)&#39;,
 &#39;Triacylglycerol (15:0/13:0/15:0)&#39;,
 &#39;Triacylglycerol (15:0/13:0/17:0)&#39;,
 &#39;Triacylglycerol (15:0/15:0/13:0)&#39;,
 &#39;Triacylglycerol (15:0/15:0/15:0)&#39;,
 &#39;Triacylglycerol (15:0/15:0/17:0)&#39;,
 &#39;Triacylglycerol (15:0/17:0/13:0)&#39;,
 &#39;Triacylglycerol (15:0/17:0/15:0)&#39;,
 &#39;Triacylglycerol (15:0/17:0/17:0)&#39;,
 &#39;Triacylglycerol (17:0/13:0/13:0)&#39;,
 &#39;Triacylglycerol (17:0/13:0/15:0)&#39;,
 &#39;Triacylglycerol (17:0/13:0/17:0)&#39;,
 &#39;Triacylglycerol (17:0/15:0/13:0)&#39;,
 &#39;Triacylglycerol (17:0/15:0/15:0)&#39;,
 &#39;Triacylglycerol (17:0/15:0/17:0)&#39;,
 &#39;Triacylglycerol (17:0/17:0/13:0)&#39;,
 &#39;Triacylglycerol (17:0/17:0/15:0)&#39;,
 &#39;Triacylglycerol (17:0/17:0/17:0)&#39;]
</pre></div>
</div>
</div>
</div>
<p>Now we can also consider which SL IDs have the highest number of synonyms linked to them</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute in-degree centrality</span>
<span class="n">deg</span> <span class="o">=</span> <span class="n">gv</span><span class="o">.</span><span class="n">degree_property_map</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    535047
1    528310
2     19619
3       227
4         6
5         1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">gv</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;node_id_decoded&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">gv</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span> <span class="k">if</span> <span class="n">gv</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s1">&#39;layer_decoded&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;swisslipids&#39;</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;SLM:000508891&#39;,
 &#39;SLM:000508893&#39;,
 &#39;SLM:000508950&#39;,
 &#39;SLM:000509166&#39;,
 &#39;SLM:000509167&#39;,
 &#39;SLM:000509168&#39;,
 &#39;SLM:000509169&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/.lipinet_logo_v1_0051.png" alt="Logo of LipiNet"/>
            </a></p>
<h1 class="logo"><a href="../index.html">LipiNet</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Main:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">LipiNet API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebooks:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="parsing_swisslipids.html">Parsing SwissLipids into a network for LipiNet</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exploring SwissLipids from a network perspective</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#loading-dependencies-and-data">Loading dependencies and data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-the-network-with-onionnet">Building the network with OnionNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering-the-network">Filtering the network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exploring-bipartite-networks">Exploring bipartite networks</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="parsing_swisslipids.html" title="previous chapter">Parsing SwissLipids into a network for LipiNet</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Macabe Daley et al..
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/notebooks/explore_swisslipids.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>